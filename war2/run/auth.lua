
function auth()
	coff = {}
	coff[0] = 163
	coff[1] = 116
	coff[2] = 37
	coff[3] = 106
	coff[4] = 63
	coff[5] = 104
	coff[6] = 5
	coff[7] = 183
	coff[8] = 147
	coff[9] = 208
	coff[10] = 149
	coff[11] = 114
	coff[12] = 122
	coff[13] = 254
	coff[14] = 15
	coff[15] = 19
	coff[16] = 164
	coff[17] = 153
	coff[18] = 57
	coff[19] = 57
	coff[20] = 161
	coff[21] = 236
	coff[22] = 189
	coff[23] = 119
	coff[24] = 112
	coff[25] = 217
	coff[26] = 243
	coff[27] = 242
	coff[28] = 230
	coff[29] = 196
	coff[30] = 86
	coff[31] = 137
	coff[32] = 56
	coff[33] = 122
	coff[34] = 243
	coff[35] = 119
	coff[36] = 226
	coff[37] = 247
	coff[38] = 47
	coff[39] = 117
	coff[40] = 199
	coff[41] = 196
	coff[42] = 231
	coff[43] = 66
	coff[44] = 195
	coff[45] = 246
	coff[46] = 85
	coff[47] = 103
	coff[48] = 144
	coff[49] = 142
	coff[50] = 159
	coff[51] = 49
	coff[52] = 122
	coff[53] = 92
	coff[54] = 167
	coff[55] = 234
	coff[56] = 54
	coff[57] = 155
	coff[58] = 221
	coff[59] = 28
	coff[60] = 96
	coff[61] = 51
	coff[62] = 165
	coff[63] = 152
	coff[64] = 173
	coff[65] = 153
	coff[66] = 16
	coff[67] = 144
	coff[68] = 144
	coff[69] = 62
	coff[70] = 5
	coff[71] = 88
	coff[72] = 3
	coff[73] = 236
	coff[74] = 154
	coff[75] = 197
	coff[76] = 227
	coff[77] = 238
	coff[78] = 45
	coff[79] = 115
	coff[80] = 125
	coff[81] = 203
	coff[82] = 163
	coff[83] = 247
	coff[84] = 40
	coff[85] = 75
	coff[86] = 225
	coff[87] = 94
	coff[88] = 230
	coff[89] = 191
	coff[90] = 122
	coff[91] = 70
	coff[92] = 242
	coff[93] = 32
	coff[94] = 221
	coff[95] = 159
	coff[96] = 184
	coff[97] = 236
	coff[98] = 47
	coff[99] = 72
	coff[100] = 43
	coff[101] = 52
	coff[102] = 160
	coff[103] = 45
	coff[104] = 33
	coff[105] = 59
	coff[106] = 242
	coff[107] = 4
	coff[108] = 42
	coff[109] = 31
	coff[110] = 118
	coff[111] = 166
	coff[112] = 234
	coff[113] = 26
	coff[114] = 157
	coff[115] = 18
	coff[116] = 101
	coff[117] = 127
	coff[118] = 112
	coff[119] = 75
	coff[120] = 63
	coff[121] = 233
	coff[122] = 145
	coff[123] = 49
	coff[124] = 9
	coff[125] = 111
	coff[126] = 208
	coff[127] = 193
	coff[128] = 91
	coff[129] = 255
	coff[130] = 10
	coff[131] = 134
	coff[132] = 52
	coff[133] = 169
	coff[134] = 179
	coff[135] = 84
	coff[136] = 227
	coff[137] = 165
	coff[138] = 88
	coff[139] = 13
	coff[140] = 196
	coff[141] = 205
	coff[142] = 179
	coff[143] = 174
	coff[144] = 231
	coff[145] = 80
	coff[146] = 192
	coff[147] = 76
	coff[148] = 207
	coff[149] = 49
	coff[150] = 151
	coff[151] = 14
	coff[152] = 26
	coff[153] = 41
	coff[154] = 63
	coff[155] = 35
	coff[156] = 151
	coff[157] = 15
	coff[158] = 227
	coff[159] = 242
	coff[160] = 15
	coff[161] = 236
	coff[162] = 120
	coff[163] = 66
	coff[164] = 150
	coff[165] = 44
	coff[166] = 150
	coff[167] = 122
	coff[168] = 208
	coff[169] = 237
	coff[170] = 135
	coff[171] = 149
	coff[172] = 186
	coff[173] = 58
	coff[174] = 68
	coff[175] = 162
	coff[176] = 138
	coff[177] = 5
	coff[178] = 238
	coff[179] = 89
	coff[180] = 53
	coff[181] = 134
	coff[182] = 103
	coff[183] = 79
	coff[184] = 174
	coff[185] = 165
	coff[186] = 114
	coff[187] = 69
	coff[188] = 180
	coff[189] = 85
	coff[190] = 55
	coff[191] = 194
	coff[192] = 66
	coff[193] = 175
	coff[194] = 5
	coff[195] = 216
	coff[196] = 218
	coff[197] = 154
	coff[198] = 82
	coff[199] = 171
	coff[200] = 135
	coff[201] = 217
	coff[202] = 64
	coff[203] = 66
	coff[204] = 19
	coff[205] = 132
	coff[206] = 227
	coff[207] = 156
	coff[208] = 136
	coff[209] = 210
	coff[210] = 245
	coff[211] = 188
	coff[212] = 88
	coff[213] = 92
	coff[214] = 12
	coff[215] = 7
	coff[216] = 2
	coff[217] = 125
	coff[218] = 75
	coff[219] = 181
	coff[220] = 210
	coff[221] = 130
	coff[222] = 120
	coff[223] = 20
	coff[224] = 49
	coff[225] = 124
	coff[226] = 236
	coff[227] = 12
	coff[228] = 22
	coff[229] = 63
	coff[230] = 182
	coff[231] = 156
	coff[232] = 24
	coff[233] = 246
	coff[234] = 222
	coff[235] = 43
	coff[236] = 122
	coff[237] = 194
	coff[238] = 199
	coff[239] = 2
	coff[240] = 148
	coff[241] = 188
	coff[242] = 190
	coff[243] = 236
	coff[244] = 25
	coff[245] = 201
	coff[246] = 242
	coff[247] = 26
	coff[248] = 71
	coff[249] = 62
	coff[250] = 207
	coff[251] = 25
	coff[252] = 191
	coff[253] = 71
	coff[254] = 45
	coff[255] = 240
	coff[256] = 195
	coff[257] = 25
	coff[258] = 251
	coff[259] = 216
	coff[260] = 88
	coff[261] = 177
	coff[262] = 117
	coff[263] = 111
	coff[264] = 167
	coff[265] = 83
	coff[266] = 154
	coff[267] = 34
	coff[268] = 21
	coff[269] = 97
	coff[270] = 35
	coff[271] = 169
	coff[272] = 30
	coff[273] = 225
	coff[274] = 149
	coff[275] = 54
	coff[276] = 171
	coff[277] = 135
	coff[278] = 80
	coff[279] = 241
	coff[280] = 196
	coff[281] = 32
	coff[282] = 10
	coff[283] = 132
	coff[284] = 102
	coff[285] = 54
	coff[286] = 116
	coff[287] = 41
	coff[288] = 79
	coff[289] = 111
	coff[290] = 2
	coff[291] = 166
	coff[292] = 33
	coff[293] = 118
	coff[294] = 22
	coff[295] = 199
	coff[296] = 201
	coff[297] = 175
	coff[298] = 233
	coff[299] = 222
	coff[300] = 16

	function crash()
	
	end

	function string.fromhex_base(str,base)
		return (string.gsub(str, '..', function (cc)
			return string.char( (tonumber(cc, 16)+base) % 256 )
		end))
	end

	function split(source, delimiters)
		local elements = {}
		local pattern = '([^'..delimiters..']+)'
		string.gsub(source, pattern, function(value) elements[#elements + 1] = value; end);
		return elements
	end


	--[[parse_game_ver( string.fromhex_base("498953E04D85", 0), 
						"xxxxxx",
					string.fromhex_base("488BC441574883EC60488958184C", 0), 
						"xxxxxxxxxxxxxx",
					string.fromhex_base("488B05000000004833C448898500000000488B72", 0), 
						"xxx????xxxxxx????xxx",
					"Warframe.x64.exe")]]--


	n1 = math.random(10000)-1
	n2 = math.random(10000)-1

	s = string.format( "0x%04d%04d", n1, n2 )
	s1 = string.sub( s, 3, 4 )
	s2 = string.sub( s, 5, 6 )
	s3 = string.sub( s, 7, 8 )
	s4 = string.sub( s, 9, 10 )

	n1 = tonumber(s1)
	n2 = tonumber(s2) + 1
	n3 = tonumber(s3) + 2
	n4 = tonumber(s4) + 3
	n = "" .. n1 .. n2 .. n3 .. n4

	t = get_registry()
	t.s = s
	t.n = n

	login = possible_login
	pass = "pass"

	body = http_request("/auth?s="..s.."&l="..login.."&p="..sha2(pass), "10.0.0.2", 8086)

	if body == "auth failed" then
		messagebox("auth failed");
		crash()
	else
		body = split(body, "=")[2]
		print(body)
		patterns = split(body, ";")

		print(n1,n2,n3,n4)
		for _, v in pairs(patterns) do print(v) end

		x = "x"
		q = "?"

		p1 = x..x..x..x..x..x
		p2 = x..x..x..x..x..x..x..x..x..x..x..x..x..x
		p3 = x..x..x..q..q..q..q..x..x..x..x..x..x..q..q..q..q..x..x..x
		p4 = x..x..x..x..x..x..x..x..x..x

		parse_game_ver(	string.fromhex_base(patterns[1],n1), p1,
						string.fromhex_base(patterns[2],n2), p2,
						string.fromhex_base(patterns[3],n3), p3,
						--string.fromhex_base(patterns[4],n4), p4,
						"Wa".."rfr".."ame"..".".."x64"..".".."e".."xe")
	end

	messagebox("test")
end

possible_login = nil

real_login = nil

if not or_split then
	or_split = string[to_token("0xDE44F664")]
end

if not or_print then
	or_print = _G[to_token("0x93B1256B")]
end

string[to_token("0xDE44F664")] = function( t, s )
	if s == "[^%@]+$" then
		if possible_login == t then
			real_login = t
			print("real login", t)
			auth()
		else
			possible_login = nil
		end
	end

	if s == "@" then
		possible_login = t
	end

	return (or_split(t, s))
end

_G[to_token("0x93B1256B")] = function( a1, ... )
	if a1 == "MainMenu::LoginDone result=true" then
		messagebox("auth")
		auth()
	end
	print( a1, ... )
end